<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Leaderboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #0f172a, #1e293b);
      color: white;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 40px;
      min-height: 100vh;
    }
    .container { width: 100%; max-width: 900px; }
    .title { 
      text-align: center; 
      font-size: 40px; 
      font-weight: bold; 
      margin-bottom: 30px; 
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #facc15;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.6);
    }
    .house {
      display: flex; 
      align-items: center; 
      justify-content: space-between;
      background: rgba(255, 255, 255, 0.12); 
      padding: 18px; 
      margin-bottom: 16px;
      border-radius: 12px; 
      transition: transform 0.3s ease, background 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .house:hover { 
      transform: scale(1.03); 
      background: rgba(255, 255, 255, 0.18);
    }
    .progress { 
      height: 20px; 
      border-radius: 10px; 
      margin-top: 10px;
      background: rgba(255, 255, 255, 0.25); 
      overflow: hidden; 
      width: 300px;
    }
    .bar { 
      height: 100%; 
      border-radius: 10px; 
      transition: width 0.6s ease, background 0.3s ease; 
    }
    .red { background: #ef4444; } 
    .blue { background: #3b82f6; }
    .yellow { background: #eab308; } 
    .green { background: #10b981; }
    .buttons { text-align: center; margin-top: 30px; }
    button {
      padding: 12px 20px; 
      border: none; 
      border-radius: 10px; 
      cursor: pointer;
      font-size: 16px; 
      background: white; 
      color: black; 
      font-weight: bold;
      margin: 0 8px;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      background: #ddd;
      transform: scale(1.05);
    }
    .nameRow { 
      display: flex; 
      align-items: center; 
      gap: 12px; 
      font-size: 22px; 
      font-weight: bold;
    }
    .medal {
      font-size: 26px;
    }

    /* Podium Wrapper */
    #podiumWrapper {
      display: none;
      margin-top: 40px;
      animation: fadeIn 0.5s ease-in-out;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      border-radius: 20px;
      padding: 20px;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .podium {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 20px;
      flex-wrap: wrap;
      padding: 20px;
    }

    .podiumBlock {
      flex: 1 1 200px;
      text-align: center;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      font-weight: bold;
      transition: transform 0.3s ease;
    }

    .podiumBlock:hover {
      transform: translateY(-10px) scale(1.05);
    }

    .first { order: 2; height: 180px; background: #facc15; }
    .second { order: 1; height: 140px; background: #cbd5e1; }
    .third { order: 3; height: 120px; background: #f97316; }
    .fourth { order: 4; height: 100px; background: #94a3b8; }

    .red-bg { background: #ef4444; color: white; }
    .blue-bg { background: #3b82f6; color: white; }
    .green-bg { background: #10b981; color: white; }
    .yellow-bg { background: #facc15; color: black; }

    /* Congrats Message */
    .winnerTitle {
      text-align: center;
      font-size: 32px;
      margin-bottom: 20px;
      color: #38bdf8;
      font-weight: bold;
      text-transform: uppercase;
      animation: glow 1.5s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px #38bdf8, 0 0 20px #0ea5e9; }
      to { text-shadow: 0 0 20px #38bdf8, 0 0 40px #0ea5e9; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">üèÜ House Leaderboard üèÜ</div>
    <div id="leaderboard"></div>

    <div id="podiumWrapper">
      <div class="winnerTitle">üéâ Congratulations to all the winners!! üéâ</div>
      <div id="podium" class="podium"></div>
      <div style="text-align:center; margin-top:20px;">
        <button onclick="launchConfetti()">Replay Celebration üéä</button>
      </div>
    </div>

    <br><br>
    <div class="buttons">
      <button onclick="goBack()">Back to Quiz</button>
      <button onclick="resetScores()">Reset Scores</button>
      <button onclick="editScores()">Edit Scores</button>
      <button onclick="togglePodium()">Show Podium</button>
    </div>

    <div id="editForm" style="display:none; margin-top:20px; text-align:center;">
      <h3>Edit House Scores</h3>
      <div id="editInputs"></div>
      <button onclick="saveScores()">Save</button>
      <button onclick="cancelEdit()">Cancel</button>
    </div>
  </div>
</body>
  <!-- Confetti Library -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
function ensureHouseScores() {
  const existing = localStorage.getItem("houseScores");
  if (!existing) {
    const defaultData = [
      { id: "red", name: "RED", color: "red", score: 0 },
      { id: "blue", name: "BLUE", color: "blue", score: 0 },
      { id: "yellow", name: "YELLOW", color: "yellow", score: 0 },
      { id: "green", name: "GREEN", color: "green", score: 0 }
    ];
    localStorage.setItem("houseScores", JSON.stringify(defaultData));
  }
}

function goBack() {
  window.history.back();
}

function editScores() {
  ensureHouseScores();
  const data = JSON.parse(localStorage.getItem("houseScores"));

  const editInputs = document.getElementById("editInputs");
  editInputs.innerHTML = "";

  data.forEach(h => {
    editInputs.innerHTML += `
      <div style="margin:8px;">
        <label style="margin-right:10px;">${h.name}:</label>
        <input type="number" id="score-${h.id}" value="${h.score}" style="width:80px;">
      </div>
    `;
  });

  document.getElementById("editForm").style.display = "block";
}

function saveScores() {
  const data = [
    { id: "red", name: "RED", color: "red", score: parseInt(document.getElementById("score-red").value) || 0 },
    { id: "blue", name: "BLUE", color: "blue", score: parseInt(document.getElementById("score-blue").value) || 0 },
    { id: "yellow", name: "YELLOW", color: "yellow", score: parseInt(document.getElementById("score-yellow").value) || 0 },
    { id: "green", name: "GREEN", color: "green", score: parseInt(document.getElementById("score-green").value) || 0 }
  ];

  localStorage.setItem("houseScores", JSON.stringify(data));
  loadScores();
  document.getElementById("editForm").style.display = "none";
  alert("Scores updated successfully!");
}

function cancelEdit() {
  document.getElementById("editForm").style.display = "none";
}

function resetScores() {
  if (!confirm("Are you sure you want to reset all scores?")) return;
  const defaultData = [
    { id: "red", name: "RED", color: "red", score: 0 },
    { id: "blue", name: "BLUE", color: "blue", score: 0 },
    { id: "yellow", name: "YELLOW", color: "yellow", score: 0 },
    { id: "green", name: "GREEN", color: "green", score: 0 }
  ];
  localStorage.setItem("houseScores", JSON.stringify(defaultData));
  loadScores();
  alert("All scores have been reset!");
}

function launchConfetti() {
  const duration = 3 * 1000;
  const end = Date.now() + duration;

  (function frame() {
    confetti({
      particleCount: 5,
      angle: 60,
      spread: 55,
      origin: { x: 0 }
    });
    confetti({
      particleCount: 5,
      angle: 120,
      spread: 55,
      origin: { x: 1 }
    });

    if (Date.now() < end) {
      requestAnimationFrame(frame);
    }
  }());
}

function togglePodium() {
  const wrapper = document.getElementById("podiumWrapper");
  const isHidden = wrapper.style.display === "none";
  wrapper.style.display = isHidden ? "block" : "none";
  if (isHidden) launchConfetti();
}

function loadScores() {
  ensureHouseScores();
  const data = JSON.parse(localStorage.getItem("houseScores"));

  const container = document.getElementById("leaderboard");
  container.innerHTML = "";

  const maxScore = Math.max(...data.map(h => h.score), 1);
  const sorted = [...data].sort((a, b) => b.score - a.score);

  sorted.forEach((h, i) => {
    let medal = "";
    if (i === 0) medal = '<span class="medal">ü•á</span>';
    else if (i === 1) medal = '<span class="medal">ü•à</span>';
    else if (i === 2) medal = '<span class="medal">ü•â</span>';

    container.innerHTML += `
      <div class="house">
        <div>
          <div class="nameRow">
            ${i + 1}. ${h.name} ${medal}
          </div>
          <div class="progress">
            <div class="bar ${h.color}" style="width:${(h.score / maxScore) * 100}%"></div>
          </div>
        </div>
        <div style="font-weight:bold; font-size:20px;">${h.score} pts</div>
      </div>
    `;
  });

  // Build podium for top 4
  const podium = document.getElementById("podium");
  podium.innerHTML = "";
  const top4 = sorted.slice(0, 4);

  top4.forEach((h, i) => {
    let cls = "";
    let medal = "";
    if (i === 0) { cls = "first"; medal = "ü•á"; }
    else if (i === 1) { cls = "second"; medal = "ü•à"; }
    else if (i === 2) { cls = "third"; medal = "ü•â"; }
    else if (i === 3) { cls = "fourth"; medal = "üèÖ"; }

    podium.innerHTML += `
      <div class="podiumBlock ${cls} ${h.color}-bg">
        <div style="font-size:24px;">${h.name}</div>
        <div style="font-size:20px;">${h.score} pts</div>
        <div style="font-size:30px;">${medal}</div>
      </div>
    `;
  });
}

// Optional: live update if localStorage changes in another tab/window
window.addEventListener("storage", (e) => {
  if (e.key === "houseScores") loadScores();
});

ensureHouseScores();
loadScores();
</script>
</html>